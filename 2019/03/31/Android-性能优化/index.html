<!DOCTYPE html>
<html lang=en>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="性能优化的几个方面 内存优化、UI 优化（布局优化和绘制优化）、速度优化（线程优化和网络优化）、电量优化、启动优化 内存优化说到内存优化，就会想到内存泄漏这一常见问题。当一些不能被回收的内存逐渐累积，也就是内存泄漏，一般会导致应用卡顿，甚至会出现 OOM 的情况。OOM 的原因是因为超过内存的阈值。原因有两个方面：  代码存在泄漏，内存无法及时释放导致 OOM 应用逻辑消耗大量内存，无法及时释放或">
<meta name="keywords" content="Android 面试">
<meta property="og:type" content="article">
<meta property="og:title" content="Android 性能优化">
<meta property="og:url" content="http://yoursite.com/2019/03/31/Android-性能优化/index.html">
<meta property="og:site_name" content="Okkenok">
<meta property="og:description" content="性能优化的几个方面 内存优化、UI 优化（布局优化和绘制优化）、速度优化（线程优化和网络优化）、电量优化、启动优化 内存优化说到内存优化，就会想到内存泄漏这一常见问题。当一些不能被回收的内存逐渐累积，也就是内存泄漏，一般会导致应用卡顿，甚至会出现 OOM 的情况。OOM 的原因是因为超过内存的阈值。原因有两个方面：  代码存在泄漏，内存无法及时释放导致 OOM 应用逻辑消耗大量内存，无法及时释放或">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/7/19/164b32fcaef88e0d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/7/19/164b32fd22d9d3db?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2017/11/16/15fc38760f9dfe35?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2017/11/16/15fc38760d5e0083?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
<meta property="og:updated_time" content="2019-03-31T08:25:43.310Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android 性能优化">
<meta name="twitter:description" content="性能优化的几个方面 内存优化、UI 优化（布局优化和绘制优化）、速度优化（线程优化和网络优化）、电量优化、启动优化 内存优化说到内存优化，就会想到内存泄漏这一常见问题。当一些不能被回收的内存逐渐累积，也就是内存泄漏，一般会导致应用卡顿，甚至会出现 OOM 的情况。OOM 的原因是因为超过内存的阈值。原因有两个方面：  代码存在泄漏，内存无法及时释放导致 OOM 应用逻辑消耗大量内存，无法及时释放或">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2018/7/19/164b32fcaef88e0d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Android 性能优化</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/03/31/MVC-MVP-MVVM/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/03/31/Android-屏幕适配/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/03/31/Android-性能优化/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/03/31/Android-性能优化/&text=Android 性能优化"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/03/31/Android-性能优化/&is_video=false&description=Android 性能优化"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Android 性能优化&body=Check out this article: http://yoursite.com/2019/03/31/Android-性能优化/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/03/31/Android-性能优化/&name=Android 性能优化&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#性能优化的几个方面"><span class="toc-number">1.</span> <span class="toc-text">性能优化的几个方面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#内存优化"><span class="toc-number">2.</span> <span class="toc-text">内存优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#如何查看内存泄漏问题（工具）"><span class="toc-number">2.1.</span> <span class="toc-text">如何查看内存泄漏问题（工具）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码习惯"><span class="toc-number">2.2.</span> <span class="toc-text">代码习惯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#具体场景及解决方式"><span class="toc-number">2.3.</span> <span class="toc-text">具体场景及解决方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-集合类泄漏"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.集合类泄漏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-单例-静态变量造成的内存泄漏"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.单例/静态变量造成的内存泄漏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-匿名内部类-非静态内部类"><span class="toc-number">2.3.3.</span> <span class="toc-text">3.匿名内部类/非静态内部类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-资源未关闭造成的内存泄漏"><span class="toc-number">2.3.4.</span> <span class="toc-text">4.资源未关闭造成的内存泄漏</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UI-优化"><span class="toc-number">3.</span> <span class="toc-text">UI 优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#布局优化"><span class="toc-number">3.1.</span> <span class="toc-text">布局优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GPU-绘制"><span class="toc-number">3.1.1.</span> <span class="toc-text">GPU 绘制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化-1"><span class="toc-number">3.1.2.</span> <span class="toc-text">优化 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPU-呈现模式分析"><span class="toc-number">3.1.3.</span> <span class="toc-text">GPU 呈现模式分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化2"><span class="toc-number">3.1.4.</span> <span class="toc-text">优化2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#启动优化"><span class="toc-number">4.</span> <span class="toc-text">启动优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#冷启动（Cold-Start）"><span class="toc-number">4.1.</span> <span class="toc-text">冷启动（Cold Start）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Application-创建"><span class="toc-number">4.1.1.</span> <span class="toc-text">Application 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Activity-创建"><span class="toc-number">4.1.2.</span> <span class="toc-text">Activity 创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#热启动（Hot-Start）"><span class="toc-number">4.2.</span> <span class="toc-text">热启动（Hot Start）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#温启动（Warm-Start）"><span class="toc-number">4.3.</span> <span class="toc-text">温启动（Warm Start）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#场景"><span class="toc-number">4.3.1.</span> <span class="toc-text">场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优化3"><span class="toc-number">4.4.</span> <span class="toc-text">优化3</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#网络优化"><span class="toc-number">5.</span> <span class="toc-text">网络优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#线程优化"><span class="toc-number">5.1.</span> <span class="toc-text">线程优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#其他优化"><span class="toc-number">6.</span> <span class="toc-text">其他优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-包体优化"><span class="toc-number">6.1.</span> <span class="toc-text">1.包体优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-耗电优化"><span class="toc-number">6.2.</span> <span class="toc-text">2.耗电优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-ListView-和-Bitmap-的优化"><span class="toc-number">6.3.</span> <span class="toc-text">3.ListView 和 Bitmap 的优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考引用"><span class="toc-number">7.</span> <span class="toc-text">参考引用</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Android 性能优化
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Okkenok</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-03-31T05:30:53.000Z" itemprop="datePublished">2019-03-31</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Android-面试/">Android 面试</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="性能优化的几个方面"><a href="#性能优化的几个方面" class="headerlink" title="性能优化的几个方面"></a>性能优化的几个方面</h1><p><img src="https://user-gold-cdn.xitu.io/2018/7/19/164b32fcaef88e0d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="快稳省小"></p>
<p>内存优化、UI 优化（布局优化和绘制优化）、速度优化（线程优化和网络优化）、电量优化、启动优化</p>
<h1 id="内存优化"><a href="#内存优化" class="headerlink" title="内存优化"></a>内存优化</h1><p>说到内存优化，就会想到内存泄漏这一常见问题。当一些不能被回收的内存逐渐累积，也就是内存泄漏，一般会导致应用卡顿，甚至会出现 OOM 的情况。OOM 的原因是因为超过内存的阈值。原因有两个方面：</p>
<ol>
<li>代码存在泄漏，内存无法及时释放导致 OOM</li>
<li>应用逻辑消耗大量内存，无法及时释放或超过导致 OOM</li>
</ol>
<p>所谓消耗大量内存，绝大多数是因为图片加载。避免的方法有：控制每次加载的数量、保证每次滑动时不进行加载滑动完毕再进行加载，等等。</p>
<h2 id="如何查看内存泄漏问题（工具）"><a href="#如何查看内存泄漏问题（工具）" class="headerlink" title="如何查看内存泄漏问题（工具）"></a>如何查看内存泄漏问题（工具）</h2><ul>
<li>Android -&gt; System Information -&gt; MemoryUsage 查看 Object 里面是否有没有被释放的 Views 和 Activitys</li>
<li>命令行：<code>adb shell dumpsys meminfo 包名 -d</code></li>
<li>AS Memory Monitor</li>
<li>LeakCanary</li>
<li>MAT 工具</li>
</ul>
<h2 id="代码习惯"><a href="#代码习惯" class="headerlink" title="代码习惯"></a>代码习惯</h2><p>尽量不要使用 Activity 的上下文，而是使用 Application 的上下文。（单例模式是最容易造成内存溢出的原因所在，因为单例模式的生命周期应该和 Application 的生命周期一样长，而不是 Activity的相同）。</p>
<p>Animation.cancel()</p>
<p>其他应注意也就都是，注意长生命周期对象持有短生命周期对象所造成的内存泄漏问题</p>
<h2 id="具体场景及解决方式"><a href="#具体场景及解决方式" class="headerlink" title="具体场景及解决方式"></a>具体场景及解决方式</h2><p>集合类泄漏、单例/静态变量造成的内存泄漏、匿名内部类/非静态内部类、资源未关闭造成的内存泄漏</p>
<h3 id="1-集合类泄漏"><a href="#1-集合类泄漏" class="headerlink" title="1.集合类泄漏"></a>1.集合类泄漏</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> List&lt;Objec&gt; mList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">100</span>; i++)&#123;</span><br><span class="line">    Object obj = <span class="keyword">new</span> Object();</span><br><span class="line">    mList.add(obj);</span><br><span class="line">    obj = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mList.clear();</span><br><span class="line">mList = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<h3 id="2-单例-静态变量造成的内存泄漏"><a href="#2-单例-静态变量造成的内存泄漏" class="headerlink" title="2.单例/静态变量造成的内存泄漏"></a>2.单例/静态变量造成的内存泄漏</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleInstance</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingleInstance mInstance;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingleInstance</span><span class="params">(Context context)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mContext = context;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingleInstance <span class="title">newInstance</span><span class="params">(Context context)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(mInstance == <span class="keyword">null</span>)&#125;&#123;</span><br><span class="line">        	mInstance = <span class="keyword">new</span> SingleInstance(context);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> mInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当在 Activity 里面使用这个的时候，我们把 Activity 的 context 传进去了，那么这个单例就持有了这个 Activity 的引用，当 Activity 被销毁了，因为这个单例还持有这个 Activity 的引用，所以 Activity 无法被 GC 回收，出现内存泄漏的问题。生命周期长的对象持有了生命周期短的对象的引用就会造成这样的问题。解决方案就是用 Application 的 Context。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SingleInstance</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SingleInstance mInstance;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">SingleInstance</span><span class="params">(Context context)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mContext = context.getApplicationContext();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SingleInstance <span class="title">newInstance</span><span class="params">(Context context)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(mInstance == <span class="keyword">null</span>)&#123;</span><br><span class="line">            mInstance = <span class="keyword">new</span> SingleInstance(context);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mInstance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-匿名内部类-非静态内部类"><a href="#3-匿名内部类-非静态内部类" class="headerlink" title="3.匿名内部类/非静态内部类"></a>3.匿名内部类/非静态内部类</h3><p><img src="https://user-gold-cdn.xitu.io/2018/7/19/164b32fd22d9d3db?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="image.png"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_test);</span><br><span class="line">        <span class="keyword">new</span> MyAsyncTask().execute();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyAsyncTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Integer</span>, <span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> String <span class="title">doInBackground</span><span class="params">(Void... params)</span></span>&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                Thread.sleep(<span class="number">100000</span>);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAsyncTask</span> <span class="keyword">extends</span> <span class="title">AsyncTask</span>&lt;<span class="title">Void</span>, <span class="title">Integer</span>, <span class="title">String</span>&gt;</span>&#123;</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>匿名内部类持有外部引用，弱引用解决内存泄漏问题</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TextView mText;</span><br><span class="line">    <span class="keyword">private</span> Handler mHandler = <span class="keyword">new</span> Handler()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>.handleMessage(msg);</span><br><span class="line">            mText.setTest(<span class="string">"do someThing"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 匿名线程持有 Activity 的引用，进行耗时操作</span></span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    Thread.sleep(<span class="number">100000</span>);</span><br><span class="line">                &#125;<span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        </span><br><span class="line">        mHandler.sendEmptyMessageDelayed(<span class="number">0</span>, <span class="number">100000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TextView mText;</span><br><span class="line">    <span class="keyword">private</span> MyHandler myHandler = <span class="keyword">new</span> MyHandler(TestActivity.<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">private</span> MyThread myThread = <span class="keyword">new</span> MyThread();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>&#123;</span><br><span class="line">        WeakReference&lt;TestActivity&gt; weakReference;</span><br><span class="line">        </span><br><span class="line">        MyHandler(TestActivity testActivity)&#123;</span><br><span class="line">            <span class="keyword">this</span>.weakReference = <span class="keyword">new</span> WeakReference&lt;TestActivity&gt;(testActivity);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span></span>&#123;</span><br><span class="line">            <span class="keyword">super</span>.handleMessage(msg);</span><br><span class="line">            <span class="keyword">if</span>(weakReference.get() != <span class="keyword">null</span>)&#123;</span><br><span class="line">                weakReference.get().mText.setText(<span class="string">"do somethings"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-资源未关闭造成的内存泄漏"><a href="#4-资源未关闭造成的内存泄漏" class="headerlink" title="4.资源未关闭造成的内存泄漏"></a>4.资源未关闭造成的内存泄漏</h3><ul>
<li>网络、文件等流忘记关闭</li>
<li>手动注册广播时，退出时忘记<code>unregisterReceiver()</code></li>
<li>Service 执行后忘记<code>stopSelf()</code></li>
<li>EventBus 等观察者模式的框架忘记手动解除注册</li>
</ul>
<h1 id="UI-优化"><a href="#UI-优化" class="headerlink" title="UI 优化"></a>UI 优化</h1><h2 id="布局优化"><a href="#布局优化" class="headerlink" title="布局优化"></a>布局优化</h2><h3 id="GPU-绘制"><a href="#GPU-绘制" class="headerlink" title="GPU 绘制"></a>GPU 绘制</h3><p>开发者选项中的 GPU 过度绘制工具进行分析</p>
<p><img src="https://user-gold-cdn.xitu.io/2017/11/16/15fc38760f9dfe35?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p>Overdraw 有时候是因为你的 UI 布局存在大量重叠的部分，还有的时候是因为非必须的重叠背景。例如某个 Activity 有一个背景，然后里面的 Layout 又有自己的背景，同时子 View 又分别有自己的背景。仅仅是通过移除非必须的背景图片，这就能减少大量的红色 Overdraw 区域，增加蓝色区域的占比。</p>
<h3 id="优化-1"><a href="#优化-1" class="headerlink" title="优化 1"></a>优化 1</h3><ol>
<li>如果父控件有颜色，也是自己需要的颜色，那么就不必在子控件加背景颜色</li>
<li>如果每个子控件的颜色不太一样，而且可以完全覆盖父控件，那么久不需要再父控件上加背景</li>
<li>尽量减少不必要的嵌套</li>
<li>能用 LinearLayout 和 FrameLayout，就不要用 RelativeLayout</li>
<li>使用 <strong>include、merge</strong> 增加复用，减少层级</li>
<li>使用 <strong>ViewStub</strong> 按需加载</li>
<li>复杂布局可选择<code>ContraintLayout</code>，可有效减少层级</li>
</ol>
<h3 id="GPU-呈现模式分析"><a href="#GPU-呈现模式分析" class="headerlink" title="GPU 呈现模式分析"></a>GPU 呈现模式分析</h3><p>开发者选项 -&gt; GPU 呈现模式分析</p>
<p><img src="https://user-gold-cdn.xitu.io/2017/11/16/15fc38760d5e0083?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p>
<p>蓝色代表测量绘制 Display List 的时间，红色代表 OpenGL 渲染 Display List 所需要的时间，黄色代表 CPU 等待 GPU 处理的时间。</p>
<p>命令行：<code>adb shell dumpsys gfxinfo [应用包名]</code>，Draw + Process + Execute = 完整的显示一帧时间 &lt; 16ms</p>
<p>我们把布局优化了，但是和布局息息相关的还有绘制，这是直接影响显示的两个根本因素。其实布局优化对于性能的提升影响不算很大，我们平时感觉的卡顿问题最主要的原因之一是因为渲染性能。<strong>Android 系统每隔 16ms 就会发出 VSYNC 信号，触发对 UI 进行渲染</strong>，但是渲染未必成功，失败了可能就会延误时间或是直接就给跳过去了。这给人的视觉上的表现就是，卡了一会儿，或是跳帧。</p>
<p><strong>View 的 绘制频率保证 60fps 是最佳的，这就要求每帧的绘制时间不超过 16ms(16ms = 1000 / 60)</strong>，虽然程序很难保证 16ms 这个时间，但是尽量降低<code>onDraw()</code>方法中的复杂度总是切实有效的。</p>
<h3 id="优化2"><a href="#优化2" class="headerlink" title="优化2"></a>优化2</h3><ol start="8">
<li><code>onDraw()</code>中不要创建新的局部对象</li>
<li><code>onDraw()</code>中不要做耗时的任务</li>
</ol>
<h1 id="启动优化"><a href="#启动优化" class="headerlink" title="启动优化"></a>启动优化</h1><p>app 启动分为<strong>冷启动（Cold Start）、热启动（Hot Start）、温启动（Warm Start）</strong>三种。</p>
<h2 id="冷启动（Cold-Start）"><a href="#冷启动（Cold-Start）" class="headerlink" title="冷启动（Cold Start）"></a>冷启动（Cold Start）</h2><p>冷启动是首次创建应用程序，在冷启动开始时，系统有三个任务：</p>
<ol>
<li>加载并启动应用程序</li>
<li>启动后立即显示应用程序的空白启动窗口</li>
<li>创建应用程序进程</li>
</ol>
<p>当系统为我们创建应用进程之后，就开始创建应用程序对象：</p>
<ol>
<li>启动主线程</li>
<li>创建主 Activity</li>
<li>加载布局</li>
<li>屏幕布局?</li>
<li>执行初始绘制</li>
</ol>
<p>应用程序进程完成第一次绘制后，系统进程会交换当前显示的背景窗口，将其替换为主 Activity。此时，用户可以开始使用该应用程序。至此启动完成。</p>
<h3 id="Application-创建"><a href="#Application-创建" class="headerlink" title="Application 创建"></a>Application 创建</h3><p><strong>当 Application 启动时，空白的启动窗口将保留在屏幕上，直到系统首次完成绘制应用程序。此时，系统进程会交换应用进程的启动窗口，允许用户开始与应用程序进行交互</strong>。这就是为什么我们的程序启动时会先出现一段时间的黑屏（白屏）。如果我们有自己的 Application，系统会<code>onCreate()</code>在我们的 Application 对象上回调该方法，之后应用程序会生成主线程（也称为 UI 线程），并通过创建主 Activity 来执行任务，开始 Activity 的生命周期。</p>
<h3 id="Activity-创建"><a href="#Activity-创建" class="headerlink" title="Activity 创建"></a>Activity 创建</h3><ol>
<li>初始化值</li>
<li>调用构造函数</li>
<li>调用回调方法，例如<code>onCreate()</code></li>
</ol>
<p>通常<code>onCreate()</code>对加载时间影响最大，因为它以最高的开销执行工作：加载和膨胀视图，以及初始化 Activity 运行所需的对象。</p>
<h2 id="热启动（Hot-Start）"><a href="#热启动（Hot-Start）" class="headerlink" title="热启动（Hot Start）"></a>热启动（Hot Start）</h2><p>比冷启动要简单得多，开销也更低。在一个热启动中，系统会把你的 Activity 带到前台。如果应用程序的 Activity 仍然驻留在内存中，那么应用程序可以避免重复对象初始化、布局加载和渲染。</p>
<p>与冷启动相同的屏幕行为：系统进程显示空白屏幕直至应用程序完成呈现 Activity。</p>
<h2 id="温启动（Warm-Start）"><a href="#温启动（Warm-Start）" class="headerlink" title="温启动（Warm Start）"></a>温启动（Warm Start）</h2><p>包含了冷启动发生的一些操作，与此同时，它的开销比热启动少，有许多潜在的状态，可以被认为是温暖的开始。</p>
<h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><ul>
<li>用户退出应用，但随后重新启动它。该过程可能已继续运行，但应用程序必须通过调用从头开始重新创建 Activity 的<code>onCreate()</code>。（仍得重跑生命周期）</li>
<li>系统将应用程序从内存中逐出，然后用户重新启动它。重新启动进程和 Activity，但是在调用<code>onCreate()</code>时可以从 Bundle （savedInstanceState）获取数据</li>
</ul>
<p>由上知，<strong>在创建应用程序和创建 Activity期间</strong>都可能出现性能问题。优化点：<strong>Application、Activity 创建以及回调等过程</strong>。</p>
<h2 id="优化3"><a href="#优化3" class="headerlink" title="优化3"></a>优化3</h2><ol>
<li>利用提前展示出来的 Window，快速展示出来一个界面，给用户快速反馈的体验</li>
<li>避免在启动时做密集沉重的初始化（Heavy app initialization）</li>
<li>避免 I/O 操作、反序列化、网络操作、布局嵌套等。</li>
</ol>
<h1 id="网络优化"><a href="#网络优化" class="headerlink" title="网络优化"></a>网络优化</h1><h2 id="线程优化"><a href="#线程优化" class="headerlink" title="线程优化"></a>线程优化</h2><p>采用线程池</p>
<p>AsyncTask、HandlerThread、ThreadPool、IntentService</p>
<h1 id="其他优化"><a href="#其他优化" class="headerlink" title="其他优化"></a>其他优化</h1><h2 id="1-包体优化"><a href="#1-包体优化" class="headerlink" title="1.包体优化"></a>1.包体优化</h2><ul>
<li><code>lint</code>工具查找去除无用资源</li>
<li>资源压缩、代码混淆</li>
<li>某些情况下可使用绘制对象替代静态图片资源</li>
<li>重用资源、使用 WebP 文件格式</li>
<li>插件化，按需下载</li>
</ul>
<h2 id="2-耗电优化"><a href="#2-耗电优化" class="headerlink" title="2.耗电优化"></a>2.耗电优化</h2><p><code>JobScheduler</code>来调整任务优先级等策略来达到降低损耗的目的，避免在不合适的时间（低电量、弱网络）执行过多的任务损耗电量。</p>
<p>具体功能：</p>
<ol>
<li>可以推迟的非面向用户的任务（如定期数据库数据更新）</li>
<li>当充电时才希望执行的任务（如数据备份）</li>
<li>需要访问网络或 Wifi 链接的任务（如向服务器拉取配置数据）</li>
<li>零散任务合并到一个批次去定期执行</li>
<li>当设备空闲时启动某些任务</li>
<li>只有当条件得到满足，系统才会启动计划中的任务（充电、WiFi）</li>
</ol>
<h2 id="3-ListView-和-Bitmap-的优化"><a href="#3-ListView-和-Bitmap-的优化" class="headerlink" title="3.ListView 和 Bitmap 的优化"></a>3.ListView 和 Bitmap 的优化</h2><p>ListView 使用 ViewHolder，分段，分页加载</p>
<p>压缩 Bitmap</p>
<hr>
<h1 id="参考引用"><a href="#参考引用" class="headerlink" title="参考引用"></a>参考引用</h1><p><a href="https://juejin.im/post/5a0d30e151882546d71ee49e" target="_blank" rel="noopener">Android性能优化全方面解析</a></p>
<p><a href="https://juejin.im/post/5b50b017f265da0f7b2f649c#heading-13" target="_blank" rel="noopener">Android 性能优化最佳实践</a></p>
<p><a href="http://hukai.me/android-performance-patterns/" target="_blank" rel="noopener">Android性能优化典范 - 第1季</a></p>

  </div>
</article>

	<div class="blog-post-comments">
        
        
        <div class="vcomment"></div>
        
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#性能优化的几个方面"><span class="toc-number">1.</span> <span class="toc-text">性能优化的几个方面</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#内存优化"><span class="toc-number">2.</span> <span class="toc-text">内存优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#如何查看内存泄漏问题（工具）"><span class="toc-number">2.1.</span> <span class="toc-text">如何查看内存泄漏问题（工具）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码习惯"><span class="toc-number">2.2.</span> <span class="toc-text">代码习惯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#具体场景及解决方式"><span class="toc-number">2.3.</span> <span class="toc-text">具体场景及解决方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-集合类泄漏"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.集合类泄漏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-单例-静态变量造成的内存泄漏"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.单例/静态变量造成的内存泄漏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-匿名内部类-非静态内部类"><span class="toc-number">2.3.3.</span> <span class="toc-text">3.匿名内部类/非静态内部类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-资源未关闭造成的内存泄漏"><span class="toc-number">2.3.4.</span> <span class="toc-text">4.资源未关闭造成的内存泄漏</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#UI-优化"><span class="toc-number">3.</span> <span class="toc-text">UI 优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#布局优化"><span class="toc-number">3.1.</span> <span class="toc-text">布局优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GPU-绘制"><span class="toc-number">3.1.1.</span> <span class="toc-text">GPU 绘制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化-1"><span class="toc-number">3.1.2.</span> <span class="toc-text">优化 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GPU-呈现模式分析"><span class="toc-number">3.1.3.</span> <span class="toc-text">GPU 呈现模式分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化2"><span class="toc-number">3.1.4.</span> <span class="toc-text">优化2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#启动优化"><span class="toc-number">4.</span> <span class="toc-text">启动优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#冷启动（Cold-Start）"><span class="toc-number">4.1.</span> <span class="toc-text">冷启动（Cold Start）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Application-创建"><span class="toc-number">4.1.1.</span> <span class="toc-text">Application 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Activity-创建"><span class="toc-number">4.1.2.</span> <span class="toc-text">Activity 创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#热启动（Hot-Start）"><span class="toc-number">4.2.</span> <span class="toc-text">热启动（Hot Start）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#温启动（Warm-Start）"><span class="toc-number">4.3.</span> <span class="toc-text">温启动（Warm Start）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#场景"><span class="toc-number">4.3.1.</span> <span class="toc-text">场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优化3"><span class="toc-number">4.4.</span> <span class="toc-text">优化3</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#网络优化"><span class="toc-number">5.</span> <span class="toc-text">网络优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#线程优化"><span class="toc-number">5.1.</span> <span class="toc-text">线程优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#其他优化"><span class="toc-number">6.</span> <span class="toc-text">其他优化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-包体优化"><span class="toc-number">6.1.</span> <span class="toc-text">1.包体优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-耗电优化"><span class="toc-number">6.2.</span> <span class="toc-text">2.耗电优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-ListView-和-Bitmap-的优化"><span class="toc-number">6.3.</span> <span class="toc-text">3.ListView 和 Bitmap 的优化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考引用"><span class="toc-number">7.</span> <span class="toc-text">参考引用</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/03/31/Android-性能优化/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/03/31/Android-性能优化/&text=Android 性能优化"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/03/31/Android-性能优化/&is_video=false&description=Android 性能优化"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Android 性能优化&body=Check out this article: http://yoursite.com/2019/03/31/Android-性能优化/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/03/31/Android-性能优化/&title=Android 性能优化"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/03/31/Android-性能优化/&name=Android 性能优化&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 黄耿
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

    <!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->

<!-- Valine Comments -->

<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
<script type="text/javascript">
    var notify = 'false' == true ? true : false;
    var verify = 'false' == true ? true : false;
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = 'nick,mail,link'.split(',').filter(function(item){
      return GUEST_INFO.indexOf(item) > -1
    });
    guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "QkzLlK1k0KOnWTQtGcA7pnfP-gzGzoHsz",
        appKey: "3x2y811wfs2AtVQEz7kKeMhL",
        avatar:"mm",
        placeholder: "say somethings ?",
        guest_info:guest_info,
        pageSize:"10"
    })
</script>
 
</body>
</html>
